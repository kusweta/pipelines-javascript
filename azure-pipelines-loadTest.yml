# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master

pool:
  vmImage: ubuntu-latest

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '12'
  displayName: 'Install Node.js'

- task: loadTest@1
  inputs:
    tenantId: '$(tenantId)'
    yamlFile: 'loadTest.yaml'
    subscription: '$(azureSubscription)'
    loadTestRes: 'cloudtestres'
    resourcegroup: 'requestworkerdev'
    monitor: |
      resourceId: /subscriptions/7c71b563-0dc0-4bc0-bcf6-06f8f0516c7a/resourceGroups/abhi-azload/providers/Microsoft.Storage/storageAccounts/abhiazload
      resourceName: Storage Account
    apikey: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldC8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC83MmY5ODhiZi04NmYxLTQxYWYtOTFhYi0yZDdjZDAxMWRiNDcvIiwiaWF0IjoxNjMwNjY1MTg1LCJuYmYiOjE2MzA2NjUxODUsImV4cCI6MTYzMDY2OTA4NSwiX2NsYWltX25hbWVzIjp7Imdyb3VwcyI6InNyYzEifSwiX2NsYWltX3NvdXJjZXMiOnsic3JjMSI6eyJlbmRwb2ludCI6Imh0dHBzOi8vZ3JhcGgud2luZG93cy5uZXQvNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3L3VzZXJzL2I0MmNjZGE3LWFiYWUtNGNkNi1hOWM4LTNjMzg0OTA2NDhlNy9nZXRNZW1iZXJPYmplY3RzIn19LCJhY3IiOiIxIiwiYWlvIjoiQVVRQXUvOFRBQUFBam04MmVxcnB6TjhQd2lORjBybElEUWFpdXhEdEdialE0Mkdxd3BiQ25hWnFyTUJYbC9ES2E3aFlNb25vVTF6WnVGaEtlMEFJSUhBRFZ3Y0t1T0dDZnc9PSIsImFtciI6WyJyc2EiLCJtZmEiXSwiYXBwaWQiOiIwNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDYiLCJhcHBpZGFjciI6IjAiLCJkZXZpY2VpZCI6IjkwODFhNDNkLTQ4ODMtNGQxZC05NWY3LWUwMzEwYTg0ZjQ1ZSIsImZhbWlseV9uYW1lIjoiS3VtYXJpIiwiZ2l2ZW5fbmFtZSI6IlN3ZXRhIiwiaXBhZGRyIjoiMTAzLjYxLjExMy43MSIsIm5hbWUiOiJTd2V0YSBLdW1hcmkiLCJvaWQiOiJiNDJjY2RhNy1hYmFlLTRjZDYtYTljOC0zYzM4NDkwNjQ4ZTciLCJvbnByZW1fc2lkIjoiUy0xLTUtMjEtMjE0Njc3MzA4NS05MDMzNjMyODUtNzE5MzQ0NzA3LTI3MTQyMzkiLCJwdWlkIjoiMTAwMzIwMDEyRUVGQjZCMCIsInJoIjoiMC5BUm9BdjRqNWN2R0dyMEdScXkxODBCSGJSNVYzc0FUYmpScEd1LTRDLWVHX2UwWWFBSXcuIiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoiSC1ob2E2UTVXTmlvUXJzaHJsb0RTaEJub280Q1pYUGN6TjFpVjdITHVSWSIsInRpZCI6IjcyZjk4OGJmLTg2ZjEtNDFhZi05MWFiLTJkN2NkMDExZGI0NyIsInVuaXF1ZV9uYW1lIjoic3dldGFrdW1hcmlAbWljcm9zb2Z0LmNvbSIsInVwbiI6InN3ZXRha3VtYXJpQG1pY3Jvc29mdC5jb20iLCJ1dGkiOiJ1RHJGX2dNZEJVcVNvcDlvZlVzU0FBIiwidmVyIjoiMS4wIiwid2lkcyI6WyJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX3RjZHQiOjEyODkyNDE1NDd9.efjX7ffwJlKuOhLxms2yhSdbyiHoFm93eIrYsvduKcuvru9eK53lkqodeaRau0oZNUxWg9tkaciB5qlAAfGw0cn2093ko1p23L4Ch7GHbfczboeOBjdOwf459FO1X1hWj9eVRqNX95I7RT6P_sxd3vbV2Tqr0irrz3PJwBoQmWMPfcPsOqWsxv44osJG2eSCxKFFTqmqnycDeHSIbqj-BXJQTdXLQm8wS8AREa3MrYdJggTis8yHwykJ9EEt22jdUFavriQZJVagj-mX9v6lZEHPABvw9l8q_jMG4g7ACaM01hrRtDCyUpdulldjeCPMgTfRSEnj0qah5ICYWZdpMg'