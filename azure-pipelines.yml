# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master

jobs:
- job: myJob
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '10.x'
    displayName: 'Install Node.js'

  - script: |
      npm install
      npm run build
    displayName: 'npm install and build'

- job: extTask
  pool: server
  steps:
  - task: loadTest@0
    inputs:
      resourceId: '/subscriptions/7c71b563-0dc0-4bc0-bcf6-06f8f0516c7a/resourcegroups/requestworkerdev/providers/microsoft.loadtestservice/loadtests/cloudtestres'
      apikey: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldC8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC83MmY5ODhiZi04NmYxLTQxYWYtOTFhYi0yZDdjZDAxMWRiNDcvIiwiaWF0IjoxNjI5MzUxMTU1LCJuYmYiOjE2MjkzNTExNTUsImV4cCI6MTYyOTM1NTA1NSwiX2NsYWltX25hbWVzIjp7Imdyb3VwcyI6InNyYzEifSwiX2NsYWltX3NvdXJjZXMiOnsic3JjMSI6eyJlbmRwb2ludCI6Imh0dHBzOi8vZ3JhcGgud2luZG93cy5uZXQvNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3L3VzZXJzL2I0MmNjZGE3LWFiYWUtNGNkNi1hOWM4LTNjMzg0OTA2NDhlNy9nZXRNZW1iZXJPYmplY3RzIn19LCJhY3IiOiIxIiwiYWlvIjoiQVVRQXUvOFRBQUFBaW1UK1hNWEJFU2pBWTNENXFyU0d5SU0xY1daM0VqSmF1WFdOSExCcGlVYWx1ZXpUa3M4aDQrRENjTG1TanNTMjBmVGxuZ2hzaFIrZTZrREMyWk53cHc9PSIsImFtciI6WyJyc2EiLCJtZmEiXSwiYXBwaWQiOiIwNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDYiLCJhcHBpZGFjciI6IjAiLCJkZXZpY2VpZCI6IjkwODFhNDNkLTQ4ODMtNGQxZC05NWY3LWUwMzEwYTg0ZjQ1ZSIsImZhbWlseV9uYW1lIjoiS3VtYXJpIiwiZ2l2ZW5fbmFtZSI6IlN3ZXRhIiwiaXBhZGRyIjoiMTEyLjE5Ni4xNjMuMTExIiwibmFtZSI6IlN3ZXRhIEt1bWFyaSIsIm9pZCI6ImI0MmNjZGE3LWFiYWUtNGNkNi1hOWM4LTNjMzg0OTA2NDhlNyIsIm9ucHJlbV9zaWQiOiJTLTEtNS0yMS0yMTQ2NzczMDg1LTkwMzM2MzI4NS03MTkzNDQ3MDctMjcxNDIzOSIsInB1aWQiOiIxMDAzMjAwMTJFRUZCNkIwIiwicmgiOiIwLkFSb0F2NGo1Y3ZHR3IwR1JxeTE4MEJIYlI1VjNzQVRialJwR3UtNEMtZUdfZTBZYUFJdy4iLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJzdWIiOiJILWhvYTZRNVdOaW9RcnNocmxvRFNoQm5vbzRDWlhQY3pOMWlWN0hMdVJZIiwidGlkIjoiNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3IiwidW5pcXVlX25hbWUiOiJzd2V0YWt1bWFyaUBtaWNyb3NvZnQuY29tIiwidXBuIjoic3dldGFrdW1hcmlAbWljcm9zb2Z0LmNvbSIsInV0aSI6IlA1Ti1sbjVwb0VpUUlhVWhYSUQ0QUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfdGNkdCI6MTI4OTI0MTU0N30.hY9No-oGYWp8mFJFrg_QprPcWnmQkuRiGFo8gwikWfdIimNb-lVxDIbjcnLZO1ajdf2w75GFzd5vZvckTFhIpr5Z-5LUkCC60TEixICXkSZ-KmdQBXI7EOFndiwSDA1fUkyyREpZGVkOiBfErH0QCFDJQGczLc_2OMX8w9SxcMsfL1VM9xN9hotOx0KcdlYAGba_8wvqowAUenDWH0SO2vNBdu3KD4Me4PyE4kQVsoUN7PZZsp-UT5LXzvnvoVscWflV5rfBlMxIR6tU68JtMSqe30Kqb543XSzeF07HRLtq1ILznG-bsPrS-VWV19JzLJwQiDFET28RAOzvWX3DoA'
      