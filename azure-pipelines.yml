# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master

jobs:
- job: myJob
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '10.x'
    displayName: 'Install Node.js'

  - script: |
      npm install
      npm run build
    displayName: 'npm install and build'

- job: extTask
  pool: server
  steps:
  - task: loadTest@0
    inputs:
     resourceId: /subscriptions/7c71b563-0dc0-4bc0-bcf6-06f8f0516c7a/resourcegroups/requestworkerdev/providers/microsoft.loadtestservice/loadtests/cloudtestres
     apikey: eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldC8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC83MmY5ODhiZi04NmYxLTQxYWYtOTFhYi0yZDdjZDAxMWRiNDcvIiwiaWF0IjoxNjI5NDQyODc2LCJuYmYiOjE2Mjk0NDI4NzYsImV4cCI6MTYyOTQ0Njc3NiwiX2NsYWltX25hbWVzIjp7Imdyb3VwcyI6InNyYzEifSwiX2NsYWltX3NvdXJjZXMiOnsic3JjMSI6eyJlbmRwb2ludCI6Imh0dHBzOi8vZ3JhcGgud2luZG93cy5uZXQvNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3L3VzZXJzL2I0MmNjZGE3LWFiYWUtNGNkNi1hOWM4LTNjMzg0OTA2NDhlNy9nZXRNZW1iZXJPYmplY3RzIn19LCJhY3IiOiIxIiwiYWlvIjoiQVVRQXUvOFRBQUFBMGIyVHZzd3V5UWJ4TUlFenBiaVlDSmlpdnJVeXVHWXV5V1U5Y25rM0kvWEYxQnBzUW13Wk80SnZMblBmSElJSEhuTll1c3FUdkJ6T3kvbkhqZ0ZOOXc9PSIsImFtciI6WyJyc2EiLCJtZmEiXSwiYXBwaWQiOiIwNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDYiLCJhcHBpZGFjciI6IjAiLCJkZXZpY2VpZCI6IjkwODFhNDNkLTQ4ODMtNGQxZC05NWY3LWUwMzEwYTg0ZjQ1ZSIsImZhbWlseV9uYW1lIjoiS3VtYXJpIiwiZ2l2ZW5fbmFtZSI6IlN3ZXRhIiwiaXBhZGRyIjoiMTEyLjE5Ni4xNjMuMjQ1IiwibmFtZSI6IlN3ZXRhIEt1bWFyaSIsIm9pZCI6ImI0MmNjZGE3LWFiYWUtNGNkNi1hOWM4LTNjMzg0OTA2NDhlNyIsIm9ucHJlbV9zaWQiOiJTLTEtNS0yMS0yMTQ2NzczMDg1LTkwMzM2MzI4NS03MTkzNDQ3MDctMjcxNDIzOSIsInB1aWQiOiIxMDAzMjAwMTJFRUZCNkIwIiwicmgiOiIwLkFSb0F2NGo1Y3ZHR3IwR1JxeTE4MEJIYlI1VjNzQVRialJwR3UtNEMtZUdfZTBZYUFJdy4iLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJzdWIiOiJILWhvYTZRNVdOaW9RcnNocmxvRFNoQm5vbzRDWlhQY3pOMWlWN0hMdVJZIiwidGlkIjoiNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3IiwidW5pcXVlX25hbWUiOiJzd2V0YWt1bWFyaUBtaWNyb3NvZnQuY29tIiwidXBuIjoic3dldGFrdW1hcmlAbWljcm9zb2Z0LmNvbSIsInV0aSI6InNzNUtYZzlfdEVHWHFsTTZUUEFkQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfdGNkdCI6MTI4OTI0MTU0N30.BYBXlwcHlK-3z1-KWxkIJaqYWtaitYu_O_ph2hbGvN6SMN9Ng60mb1BP54C3AAHRwE-GzNaitV2V7Z4gduB5ogCOPjT2DmJ4HVcVhtC0-Rj6wdItcFAcBCYI2V8x_Se21qoMTRPtbM8omZFAR3BKLmPhZjMdStsjJ7djo31Jr8rRgJ3Iu-xRoy2mCyXmC95gZzeCpwMZZ3Oa93Mi5adPH2MIRnfllzKTBlobcBgPe7d8h3cyzBWVQcAWZ1fc45zCJ8suFgHVRpK94gV-bGAPH_b2AKCKK3kFDp67e-4PCn0iB82JgwbZM5zzprG5j_8solg-0G5Rp6nccVT37EmYVQ